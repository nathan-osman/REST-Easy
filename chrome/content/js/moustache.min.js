/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
(function(e,t){if(typeof exports==="object"&&exports){t(exports)}else{var n={};t(n);if(typeof define==="function"&&define.amd){define(n)}else{e.Mustache=n}}})(this,function(e){function a(e,t){return u.call(e,t)}function f(e){return!a(r,e)}function h(e){return typeof e==="function"}function p(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function v(e){return String(e).replace(/[&<>"'\/]/g,function(e){return d[e]})}function m(e){this.string=e;this.tail=e;this.pos=0}function g(e,t){this.view=e==null?{}:e;this.parent=t;this._cache={".":this.view}}function y(){this.clearCache()}function b(t,n,r,i){function o(e){return n.render(e,r)}var s="";var u,a,f;for(var l=0,p=t.length;l<p;++l){u=t[l];a=u[1];switch(u[0]){case"#":f=r.lookup(a);if(typeof f==="object"||typeof f==="string"){if(c(f)){for(var d=0,v=f.length;d<v;++d){s+=b(u[4],n,r.push(f[d]),i)}}else if(f){s+=b(u[4],n,r.push(f),i)}}else if(h(f)){var m=i==null?null:i.slice(u[3],u[5]);f=f.call(r.view,m,o);if(f!=null)s+=f}else if(f){s+=b(u[4],n,r,i)}break;case"^":f=r.lookup(a);if(!f||c(f)&&f.length===0){s+=b(u[4],n,r,i)}break;case">":f=n.getPartial(a);if(h(f))s+=f(r);break;case"&":f=r.lookup(a);if(f!=null)s+=f;break;case"name":f=r.lookup(a);if(f!=null)s+=e.escape(f);break;case"text":s+=a;break}}return s}function w(e){var t=[];var n=t;var r=[];var i;for(var s=0,o=e.length;s<o;++s){i=e[s];switch(i[0]){case"#":case"^":r.push(i);n.push(i);n=i[4]=[];break;case"/":var u=r.pop();u[5]=i[2];n=r.length>0?r[r.length-1][4]:t;break;default:n.push(i)}}return t}function E(e){var t=[];var n,r;for(var i=0,s=e.length;i<s;++i){n=e[i];if(n){if(n[0]==="text"&&r&&r[0]==="text"){r[1]+=n[1];r[3]=n[3]}else{r=n;t.push(n)}}}return t}function S(e){return[new RegExp(p(e[0])+"\\s*"),new RegExp("\\s*"+p(e[1]))]}function x(r,u){function y(){if(v&&!g){while(d.length){delete h[d.pop()]}}else{d=[]}v=false;g=false}r=r||"";u=u||e.tags;if(typeof u==="string")u=u.split(n);if(u.length!==2)throw new Error("Invalid tags: "+u.join(", "));var a=S(u);var l=new m(r);var c=[];var h=[];var d=[];var v=false;var g=false;var b,x,T,N,C,k;while(!l.eos()){b=l.pos;T=l.scanUntil(a[0]);if(T){for(var L=0,A=T.length;L<A;++L){N=T.charAt(L);if(f(N)){d.push(h.length)}else{g=true}h.push(["text",N,b,b+1]);b+=1;if(N=="\n")y()}}if(!l.scan(a[0]))break;v=true;x=l.scan(o)||"name";l.scan(t);if(x==="="){T=l.scanUntil(i);l.scan(i);l.scanUntil(a[1])}else if(x==="{"){T=l.scanUntil(new RegExp("\\s*"+p("}"+u[1])));l.scan(s);l.scanUntil(a[1]);x="&"}else{T=l.scanUntil(a[1])}if(!l.scan(a[1]))throw new Error("Unclosed tag at "+l.pos);C=[x,T,b,l.pos];h.push(C);if(x==="#"||x==="^"){c.push(C)}else if(x==="/"){k=c.pop();if(!k){throw new Error('Unopened section "'+T+'" at '+b)}if(k[1]!==T){throw new Error('Unclosed section "'+k[1]+'" at '+b)}}else if(x==="name"||x==="{"||x==="&"){g=true}else if(x==="="){u=T.split(n);if(u.length!==2){throw new Error("Invalid tags at "+b+": "+u.join(", "))}a=S(u)}}k=c.pop();if(k){throw new Error('Unclosed section "'+k[1]+'" at '+l.pos)}return w(E(h))}var t=/\s*/;var n=/\s+/;var r=/\S/;var i=/\s*=/;var s=/\s*\}/;var o=/#|\^|\/|>|\{|&|=|!/;var u=RegExp.prototype.test;var l=Object.prototype.toString;var c=Array.isArray||function(e){return l.call(e)==="[object Array]"};var d={"&":"&","<":"<",">":">",'"':""","'":"&#39;","/":"&#x2F;"};m.prototype.eos=function(){return this.tail===""};m.prototype.scan=function(e){var t=this.tail.match(e);if(t&&t.index===0){var n=t[0];this.tail=this.tail.substring(n.length);this.pos+=n.length;return n}return""};m.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail;this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t);this.tail=this.tail.substring(t)}this.pos+=n.length;return n};g.make=function(e){return e instanceof g?e:new g(e)};g.prototype.push=function(e){return new g(e,this)};g.prototype.lookup=function(e){var t;if(e in this._cache){t=this._cache[e]}else{var n=this;while(n){if(e.indexOf(".")>0){t=n.view;var r=e.split("."),i=0;while(t!=null&&i<r.length){t=t[r[i++]]}}else{t=n.view[e]}if(t!=null)break;n=n.parent}this._cache[e]=t}if(h(t)){t=t.call(this.view)}return t};y.prototype.clearCache=function(){this._cache={};this._partialCache={}};y.prototype.compile=function(t,n){var r=this._cache[t];if(!r){var i=e.parse(t,n);r=this._cache[t]=this.compileTokens(i,t)}return r};y.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);this._partialCache[e]=r;return r};y.prototype.getPartial=function(e){if(!(e in this._partialCache)&&this._loadPartial){this.compilePartial(e,this._loadPartial(e))}return this._partialCache[e]};y.prototype.compileTokens=function(e,t){var n=this;return function(r,i){if(i){if(h(i)){n._loadPartial=i}else{for(var s in i){n.compilePartial(s,i[s])}}}return b(e,n,g.make(r),t)}};y.prototype.render=function(e,t,n){return this.compile(e)(t,n)};e.name="mustache.js";e.version="0.7.3";e.tags=["{{","}}"];e.Scanner=m;e.Context=g;e.Writer=y;e.parse=x;e.escape=v;var T=new y;e.clearCache=function(){return T.clearCache()};e.compile=function(e,t){return T.compile(e,t)};e.compilePartial=function(e,t,n){return T.compilePartial(e,t,n)};e.compileTokens=function(e,t){return T.compileTokens(e,t)};e.render=function(e,t,n){return T.render(e,t,n)};e.to_html=function(t,n,r,i){var s=e.render(t,n,r);if(h(i)){i(s)}else{return s}}})
